@* @page "/monthly-summary"
@inject HttpClient Http

<h3>Resumen Mensual</h3>

@if (summary is null)
{
    <p><em>Cargando...</em></p>
}
else
{
    <div class="row">
        <div class="col-4">
            <div class="card p-3 mb-3">
                <h5>Ingresos reales</h5>
                <p>@summary.TotalIncome:C</p>
            </div>
        </div>
        <div class="col-4">
            <div class="card p-3 mb-3">
                <h5>Gastos reales</h5>
                <p>@summary.TotalExpenses:C</p>
            </div>
        </div>
        <div class="col-4">
            <div class="card p-3 mb-3">
                <h5>Balance neto</h5>
                <p>@summary.NetBalance:C</p>
            </div>
        </div>
    </div>

    <h4>Presupuesto vs. Real</h4>
    <table class="table">
        <thead>
            <tr>
                <th>Concepto</th>
                <th>Presupuestado</th>
                <th>Real</th>
                <th>Desviación</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Ingresos</td>
                <td>@summary.BudgetedIncome:C</td>
                <td>@summary.TotalIncome:C</td>
                <td>@summary.IncomeVariance:C</td>
            </tr>
            <tr>
                <td>Gastos</td>
                <td>@summary.BudgetedExpenses:C</td>
                <td>@summary.TotalExpenses:C</td>
                <td>@summary.ExpenseVariance:C</td>
            </tr>
        </tbody>
    </table>
}

@code {
    private MonthlySummaryDto? summary;

    protected override async Task OnInitializedAsync()
    {
        // Por defecto: mes y año actuales
        var today = DateTime.Today;
        summary = await Http.GetFromJsonAsync<MonthlySummaryDto>(
            $"api/summary/monthly?year={today.Year}&month={today.Month}"
        );
    }
} *@
